# Complete Crop Steering Dashboard
# All phase parameters and critical configuration options
# Based on comprehensive .env parameters

type: vertical-stack
cards:
  # System Status Overview
  - type: grid
    columns: 2
    square: false
    cards:
      - type: entities
        title: üå± System Status
        show_header_toggle: false
        entities:
          - entity: sensor.crop_steering_current_phase
            name: Current Phase
          - entity: select.crop_steering_steering_mode
            name: Steering Mode
          - entity: select.crop_steering_irrigation_phase
            name: Manual Phase Override
          - entity: switch.crop_steering_system_enabled
            name: System Enabled
          - entity: switch.crop_steering_ec_stacking_enabled
            name: EC Stacking

      - type: entities
        title: üìä Live Sensor Data
        show_header_toggle: false
        entities:
          - entity: sensor.vwc_r1_front
            name: Zone 1 VWC Front (%)
          - entity: sensor.vwc_r1_back
            name: Zone 1 VWC Back (%)
          - entity: sensor.ec_r1_front
            name: Zone 1 EC Front (mS/cm)
          - entity: sensor.ec_r1_back
            name: Zone 1 EC Back (mS/cm)

  # Zone Control
  - type: entities
    title: üè† Zone Management
    show_header_toggle: false
    entities:
      - entity: switch.crop_steering_zone_1_enabled
        name: Zone 1 Active
      - entity: switch.crop_steering_zone_2_enabled
        name: Zone 2 Active
      - entity: switch.crop_steering_zone_3_enabled
        name: Zone 3 Active

  # Phase Configuration - The Critical Missing Parameters
  - type: grid
    columns: 4
    square: false
    cards:
      # P0 Phase Configuration
      - type: entities
        title: üåÖ P0 Phase - Morning Dryback
        show_header_toggle: false
        entities:
          - entity: number.crop_steering_veg_dryback_target
            name: Veg Dryback Target (%)
          - entity: number.crop_steering_gen_dryback_target
            name: Gen Dryback Target (%)
          - entity: number.crop_steering_p0_dryback_drop_percent
            name: Dryback Drop (%)
          - entity: number.crop_steering_p0_min_wait_time
            name: Min Wait Time (min)
          - entity: number.crop_steering_p0_max_wait_time
            name: Max Wait Time (min)

      # P1 Phase Configuration
      - type: entities
        title: üìà P1 Phase - Ramp Up
        show_header_toggle: false
        entities:
          - entity: number.crop_steering_p1_target_vwc
            name: Target VWC (%)
          - entity: number.crop_steering_p1_initial_shot_size
            name: Initial Shot Size (%)
          - entity: number.crop_steering_p1_shot_increment
            name: Shot Increment (%)
          - entity: number.crop_steering_p1_max_shot_size
            name: Max Shot Size (%)
          - entity: number.crop_steering_p1_time_between_shots
            name: Time Between Shots (min)
          - entity: number.crop_steering_p1_min_shots
            name: Min Shots Required
          - entity: number.crop_steering_p1_max_shots
            name: Max Shots Allowed

      # P2 Phase Configuration
      - type: entities
        title: üîÑ P2 Phase - Maintenance
        show_header_toggle: false
        entities:
          - entity: number.crop_steering_p2_vwc_threshold
            name: VWC Threshold (%)
          - entity: number.crop_steering_p2_shot_size
            name: Shot Size (%)
          - entity: number.crop_steering_p2_ec_high_threshold
            name: EC High Ratio
          - entity: number.crop_steering_p2_ec_low_threshold
            name: EC Low Ratio

      # P3 Phase Configuration
      - type: entities
        title: üåô P3 Phase - Pre-Lights-Off
        show_header_toggle: false
        entities:
          - entity: number.crop_steering_p3_veg_last_irrigation
            name: Veg Last Irrigation (min)
          - entity: number.crop_steering_p3_gen_last_irrigation
            name: Gen Last Irrigation (min)
          - entity: number.crop_steering_p3_emergency_vwc_threshold
            name: Emergency VWC (%)
          - entity: number.crop_steering_p3_emergency_shot_size
            name: Emergency Shot Size (%)

  # System Configuration
  - type: grid
    columns: 2
    square: false
    cards:
      - type: entities
        title: ‚öôÔ∏è System Parameters
        show_header_toggle: false
        entities:
          - entity: select.crop_steering_crop_type
            name: Crop Type
          - entity: number.crop_steering_substrate_volume
            name: Substrate Volume (L)
          - entity: number.crop_steering_dripper_flow_rate
            name: Flow Rate (L/hr)
          - entity: number.crop_steering_field_capacity
            name: Field Capacity (%)
          - entity: number.crop_steering_max_ec
            name: Max EC (mS/cm)

      - type: entities
        title: üìä All Zone Sensors
        show_header_toggle: false
        entities:
          - entity: sensor.vwc_r2_front
            name: Zone 2 VWC Front
          - entity: sensor.vwc_r2_back
            name: Zone 2 VWC Back
          - entity: sensor.vwc_r3_front
            name: Zone 3 VWC Front
          - entity: sensor.vwc_r3_back
            name: Zone 3 VWC Back
          - entity: sensor.ec_r2_front
            name: Zone 2 EC Front
          - entity: sensor.ec_r3_front
            name: Zone 3 EC Front

  # Hardware Control
  - type: entities
    title: üîß Hardware Control
    show_header_toggle: false
    entities:
      - type: section
        label: Main System
      - entity: switch.f1_irrigation_pump_master_switch
        name: Master Pump
      - entity: switch.espoe_irrigation_relay_1_2
        name: Main Line Valve
      - entity: switch.espoe_irrigation_relay_1_4
        name: Mains Water Valve
      - type: section
        label: Zone Valves
      - entity: switch.f1_irrigation_relays_relay_1
        name: Zone 1 Valve
      - entity: switch.f1_irrigation_relays_relay_2
        name: Zone 2 Valve
      - entity: switch.f1_irrigation_relays_relay_3
        name: Zone 3 Valve
      - type: section
        label: Utility
      - entity: switch.waste_valve
        name: Waste Valve
      - entity: switch.f1_irrigation_relays_relay_4
        name: Waste/Hose Valve
      - entity: automation.f1_irrigation_irrigate_5_minutes_every_45_minutes
        name: Legacy Timer

grid_options:
  columns: 48
  rows: auto